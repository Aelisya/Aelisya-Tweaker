[
    {
        "id": 1,
        "priority": 1,
        "action": {
            "type": "block"
        },
        "condition": {
            "regexFilter": "^(?:https|http):\/\/www.(?:bing|google).(?:[a-zA-Z0-9])\/amp\/((?:[a-zA-Z0-9.])+(?:[a-zA-Z0-9])+(?:[a-zA-Z0-9\/]*))",
            "resourceTypes": ["main_frame"]
        }
    },
    {
        "id": 2,
        "priority": 1,
        "action": {
            "type": "redirect",
            "redirect": {
                "regexSubstitution": "https://\\1"
            }
        },
        "condition": {
            "regexFilter": "^(?:https|http):\/\/www.(?:bing|google).(?:[a-zA-Z0-9])\/amp\/s\/((?:[a-zA-Z0-9.])+(?:[a-zA-Z0-9])+(?:[a-zA-Z0-9\/]*))",
            "resourceTypes": ["main_frame"]
        }
    },
    {
        "id": 3,
        "priority": 1,
        "action": {
            "type": "block"
        },
        "condition": {
            "regexFilter": "^(?:https|http):\/\/(?:.*cdn.ampproject.org|.*bing-amp.com)\/c\/((?:[a-zA-Z0-9.])+(?:[a-zA-Z0-9])+(?:[a-zA-Z0-9\/]*))", 
            "resourceTypes": ["main_frame"]
        }
    },
    {
        "id": 4,
        "priority": 1,
        "action": {
            "type": "redirect",
            "redirect": {
                "regexSubstitution": "https://\\1"
            }
        },
        "condition": {
            "regexFilter": "^(?:https|http):\/\/(?:.*cdn.ampproject.org|.*bing-amp.com)\/c\/s\/((?:[a-zA-Z0-9.])+(?:[a-zA-Z0-9])+(?:[a-zA-Z0-9\/]*))",
            "resourceTypes": ["main_frame"]
        }
    },
    {
        "id": 5,
        "priority": 1,
        "action": {
            "type": "redirect",
            "redirect": {
                "regexSubstitution": "https://t.co/\\1"
            }
        },
        "condition": {
            "regexFilter": "^(?:https|http):\/\/t.co\/(.*).+amp=1",
            "resourceTypes": ["main_frame"]
        }
    },
    {
        "id": 6,
        "priority": 1,
        "action": {
            "type": "modifyHeaders",
            "responseHeaders": [{ 
                "header": "Content-Security-Policy",
                "operation": "set",
                "value": "upgrade-insecure-requests" 
            }]
        },
        "condition": {
            "regexFilter": "^https:\/\/*",
            "resourceTypes": ["main_frame", "sub_frame", "stylesheet", "script", "image", "font", "object", "xmlhttprequest", "csp_report", "media", "websocket", "other"]
        }
        
    },
    {
        "id": 7,
        "priority": 1,
        "action": {
            "type": "block"
        },
        "condition": {
            "resourceTypes": ["ping"]
        }
    }
]